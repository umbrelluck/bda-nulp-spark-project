{
  "version": "1",
  "metadata": {
    "marimo_version": "0.12.2"
  },
  "cells": [
    {
      "id": "Hbol",
      "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": []
    },
    {
      "id": "QxEd",
      "code_hash": null,
      "outputs": [
        {
          "type": "error",
          "ename": "exception",
          "evalue": "This cell raised an exception: Py4JJavaError('An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.\n: java.lang.UnsupportedOperationException: getSubject is not supported\n\tat java.base/javax.security.auth.Subject.getSubject(Subject.java:277)\n\tat org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:577)\n\tat org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2416)\n\tat scala.Option.getOrElse(Option.scala:189)\n\tat org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2416)\n\tat org.apache.spark.SparkContext.<init>(SparkContext.scala:329)\n\tat org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)\n\tat java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62)\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\n\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:483)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\n\tat py4j.Gateway.invoke(Gateway.java:238)\n\tat py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)\n\tat py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)\n\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\n\tat py4j.ClientServerConnection.run(ClientServerConnection.java:106)\n\tat java.base/java.lang.Thread.run(Thread.java:1447)\n')",
          "traceback": []
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "25/04/03 12:44:45 WARN SparkContext: Another SparkContext is being constructed (or threw an exception in its constructor). This may indicate an error, since only one SparkContext should be running in this JVM (see SPARK-2243). The other SparkContext was created at:\norg.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)\njava.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62)\njava.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\njava.base/java.lang.reflect.Constructor.newInstance(Constructor.java:483)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)\npy4j.Gateway.invoke(Gateway.java:238)\npy4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)\npy4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)\npy4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)\npy4j.ClientServerConnection.run(ClientServerConnection.java:106)\njava.base/java.lang.Thread.run(Thread.java:1447)\n"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "<span class=\"codehilite\"><div class=\"highlight\"><pre><span></span><span class=\"gt\">Traceback (most recent call last):</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/marimo/_runtime/executor.py&quot;</span>, line <span class=\"m\">141</span>, in <span class=\"n\">execute_cell</span>\n<span class=\"w\">    </span><span class=\"n\">exec</span><span class=\"p\">(</span><span class=\"n\">cell</span><span class=\"o\">.</span><span class=\"n\">body</span><span class=\"p\">,</span> <span class=\"n\">glbls</span><span class=\"p\">)</span>\n  File <span class=\"nb\">&quot;/tmp/marimo_323652/__marimo__cell_QxEd_.py&quot;</span>, line <span class=\"m\">3</span>, in <span class=\"n\">&lt;module&gt;</span>\n<span class=\"w\">    </span><span class=\"n\">spark</span> <span class=\"o\">=</span> <span class=\"n\">SparkSession</span><span class=\"o\">.</span><span class=\"n\">builder</span><span class=\"o\">.</span><span class=\"n\">master</span><span class=\"p\">(</span><span class=\"s2\">&quot;local[*]&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">appName</span><span class=\"p\">(</span><span class=\"s2\">&quot;Test&quot;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">getOrCreate</span><span class=\"p\">()</span>\n<span class=\"w\">            </span><span class=\"pm\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/pyspark/sql/session.py&quot;</span>, line <span class=\"m\">497</span>, in <span class=\"n\">getOrCreate</span>\n<span class=\"w\">    </span><span class=\"n\">sc</span> <span class=\"o\">=</span> <span class=\"n\">SparkContext</span><span class=\"o\">.</span><span class=\"n\">getOrCreate</span><span class=\"p\">(</span><span class=\"n\">sparkConf</span><span class=\"p\">)</span>\n<span class=\"w\">         </span><span class=\"pm\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/pyspark/context.py&quot;</span>, line <span class=\"m\">515</span>, in <span class=\"n\">getOrCreate</span>\n<span class=\"w\">    </span><span class=\"n\">SparkContext</span><span class=\"p\">(</span><span class=\"n\">conf</span><span class=\"o\">=</span><span class=\"n\">conf</span> <span class=\"ow\">or</span> <span class=\"n\">SparkConf</span><span class=\"p\">())</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/pyspark/context.py&quot;</span>, line <span class=\"m\">203</span>, in <span class=\"n\">__init__</span>\n<span class=\"w\">    </span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_do_init</span><span class=\"p\">(</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/pyspark/context.py&quot;</span>, line <span class=\"m\">296</span>, in <span class=\"n\">_do_init</span>\n<span class=\"w\">    </span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_jsc</span> <span class=\"o\">=</span> <span class=\"n\">jsc</span> <span class=\"ow\">or</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_initialize_context</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_conf</span><span class=\"o\">.</span><span class=\"n\">_jconf</span><span class=\"p\">)</span>\n<span class=\"w\">                       </span><span class=\"pm\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/pyspark/context.py&quot;</span>, line <span class=\"m\">421</span>, in <span class=\"n\">_initialize_context</span>\n<span class=\"w\">    </span><span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_jvm</span><span class=\"o\">.</span><span class=\"n\">JavaSparkContext</span><span class=\"p\">(</span><span class=\"n\">jconf</span><span class=\"p\">)</span>\n<span class=\"w\">           </span><span class=\"pm\">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/py4j/java_gateway.py&quot;</span>, line <span class=\"m\">1587</span>, in <span class=\"n\">__call__</span>\n<span class=\"w\">    </span><span class=\"n\">return_value</span> <span class=\"o\">=</span> <span class=\"n\">get_return_value</span><span class=\"p\">(</span>\n<span class=\"w\">                   </span><span class=\"pm\">^^^^^^^^^^^^^^^^^</span>\n  File <span class=\"nb\">&quot;/home/umbrelluck/Documents/NULP/4.5/bdal/.venv/lib/python3.11/site-packages/py4j/protocol.py&quot;</span>, line <span class=\"m\">326</span>, in <span class=\"n\">get_return_value</span>\n<span class=\"w\">    </span><span class=\"k\">raise</span> <span class=\"n\">Py4JJavaError</span><span class=\"p\">(</span>\n<span class=\"gr\">py4j.protocol.Py4JJavaError</span>: <span class=\"n\">An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.</span>\n<span class=\"x\">: java.lang.UnsupportedOperationException: getSubject is not supported</span>\n<span class=\"x\">\tat java.base/javax.security.auth.Subject.getSubject(Subject.java:277)</span>\n<span class=\"x\">\tat org.apache.hadoop.security.UserGroupInformation.getCurrentUser(UserGroupInformation.java:577)</span>\n<span class=\"x\">\tat org.apache.spark.util.Utils$.$anonfun$getCurrentUserName$1(Utils.scala:2416)</span>\n<span class=\"x\">\tat scala.Option.getOrElse(Option.scala:189)</span>\n<span class=\"x\">\tat org.apache.spark.util.Utils$.getCurrentUserName(Utils.scala:2416)</span>\n<span class=\"x\">\tat org.apache.spark.SparkContext.&lt;init&gt;(SparkContext.scala:329)</span>\n<span class=\"x\">\tat org.apache.spark.api.java.JavaSparkContext.&lt;init&gt;(JavaSparkContext.scala:58)</span>\n<span class=\"x\">\tat java.base/jdk.internal.reflect.DirectConstructorHandleAccessor.newInstance(DirectConstructorHandleAccessor.java:62)</span>\n<span class=\"x\">\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)</span>\n<span class=\"x\">\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:483)</span>\n<span class=\"x\">\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)</span>\n<span class=\"x\">\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)</span>\n<span class=\"x\">\tat py4j.Gateway.invoke(Gateway.java:238)</span>\n<span class=\"x\">\tat py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)</span>\n<span class=\"x\">\tat py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)</span>\n<span class=\"x\">\tat py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)</span>\n<span class=\"x\">\tat py4j.ClientServerConnection.run(ClientServerConnection.java:106)</span>\n<span class=\"x\">\tat java.base/java.lang.Thread.run(Thread.java:1447)</span>\n</pre></div>\n</span>"
        }
      ]
    },
    {
      "id": "MJUe",
      "code_hash": "ce45d1668d6bdfe992ca96b280b3e320",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/plain": ""
          }
        }
      ],
      "console": [
        {
          "type": "stream",
          "name": "stderr",
          "text": "25/04/03 12:46:09 WARN Utils: Your hostname, KAermorhen resolves to a loopback address: 127.0.1.1; using 192.168.1.9 instead (on interface wlan0)\n25/04/03 12:46:09 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address\n"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "Setting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "25/04/03 12:46:11 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r[Stage 0:>                                                          (0 + 1) / 1]\r"
        },
        {
          "type": "stream",
          "name": "stderr",
          "text": "\r                                                                                \r"
        },
        {
          "type": "stream",
          "name": "stdout",
          "text": "+---+-----+\n| id| name|\n+---+-----+\n|  1|Alice|\n|  2|  Bob|\n+---+-----+\n\n"
        }
      ]
    }
  ]
}